# v2 å®Œäº†è¨ˆç”» - YouTubeLive ãƒ—ãƒ©ã‚°ã‚¤ãƒ³å®Œæˆ

**ç­–å®šæ—¥**: 2025-12-18
**å¯¾è±¡ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: v2.3.0

---

## ğŸ“‹ v2 å®Œäº†ã®å®šç¾©

**YouTubeLive ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®å®Œæˆã‚’ã‚‚ã£ã¦ v2 å®Œäº†ã¨ã™ã‚‹**

### å®Œäº†æ¡ä»¶

ä»¥ä¸‹ã®2ã¤ã®æ©Ÿèƒ½ãŒå®Ÿè£…ã•ã‚Œã€ãƒ†ã‚¹ãƒˆæ¸ˆã¿ã§ã‚ã‚‹ã“ã¨ï¼š

1. âœ… **ãƒ©ã‚¤ãƒ–é–‹å§‹/çµ‚äº†ã®è‡ªå‹•æ¤œçŸ¥**
   - RSS ã¾ãŸã¯ API ãƒãƒ¼ãƒªãƒ³ã‚°ã§ãƒ©ã‚¤ãƒ–é–‹å§‹ã‚’æ¤œçŸ¥
   - API å®šæœŸãƒãƒ¼ãƒªãƒ³ã‚°ã§ãƒ©ã‚¤ãƒ–çµ‚äº†ã‚’æ¤œçŸ¥
   - DB ã® `live_status` ã‚’è‡ªå‹•æ›´æ–°

2. âœ… **ãƒ©ã‚¤ãƒ–ã‚¤ãƒ™ãƒ³ãƒˆç”¨ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆè‡ªå‹•é©ç”¨**
   - `yt_online_template.txt`: ãƒ©ã‚¤ãƒ–é–‹å§‹æ™‚
   - `yt_offline_template.txt`: ãƒ©ã‚¤ãƒ–çµ‚äº†æ™‚
   - ã‚¤ãƒ™ãƒ³ãƒˆç¨®åˆ¥ã«å¿œã˜ã¦è‡ªå‹•é¸æŠ

### ãƒªãƒªãƒ¼ã‚¹äºˆå®š

- **ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: v2.3.0
- **ãƒªãƒªãƒ¼ã‚¹æ—¥**: å®Ÿè£…å®Œäº†å¾Œï¼ˆ2025-12-XXï¼‰

---

## ğŸ”„ v3 ã¸ã®ç¹°ã‚Šä¸‹ã’æ©Ÿèƒ½

ä»¥ä¸‹ã®æ©Ÿèƒ½ã¯ v2 ã§ã¯å®Ÿè£…ã›ãšã€v3 ã§å®Ÿè£…äºˆå®šï¼š

### 3. ä¸€æ‹¬æŠ•ç¨¿ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«æ©Ÿèƒ½
- è¤‡æ•°å‹•ç”»ã®åˆ†æ•£æŠ•ç¨¿ï¼ˆ15åˆ†é–“éš”ãªã©ï¼‰
- Bluesky API ãƒ¬ãƒ¼ãƒˆåˆ¶é™å¯¾ç­–
- **å®Ÿè£…äºˆå®š**: v3

### 4. GUI æ©Ÿèƒ½æ‹¡å¼µ
- å‹•ç”»ãƒ•ã‚£ãƒ«ã‚¿ãƒ»æ¤œç´¢æ©Ÿèƒ½
- çµ±è¨ˆè©³ç´°è¡¨ç¤º
- ã‚¯ã‚¤ãƒƒã‚¯æŠ•ç¨¿ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
- ãƒ¡ãƒ¢ãƒªåŠ¹ç‡å‘ä¸Šï¼ˆé…å»¶ç”»åƒèª­ã¿è¾¼ã¿ï¼‰
- **å®Ÿè£…äºˆå®š**: v3

### 5. ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ»å¾©å…ƒæ©Ÿèƒ½
- DBãƒ»ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ»è¨­å®šã®ä¸€æ‹¬ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ/ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
- ZIPå½¢å¼ã§ã®åœ§ç¸®ä¿å­˜
- API ã‚­ãƒ¼é™¤å¤–ã‚ªãƒ—ã‚·ãƒ§ãƒ³
- **å®Ÿè£…äºˆå®š**: v3

### ãã®ä»–ï¼ˆv3äºˆå®šï¼‰
- RSS æ‰‹å‹•æ›´æ–°ãƒœã‚¿ãƒ³
- é‡è¤‡æŠ•ç¨¿é˜²æ­¢ã‚ªãƒ—ã‚·ãƒ§ãƒ³
- æŠ•ç¨¿ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆå‹•çš„å¤‰æ•°ï¼ˆ`{{ current_date }}`ãªã©ï¼‰

---

## ğŸ“¦ å®Ÿè£…è¨ˆç”»

### Phase 1: ãƒ©ã‚¤ãƒ–é–‹å§‹æ¤œçŸ¥ï¼ˆæœ€å„ªå…ˆï¼‰

**å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«**:
- `v2/youtube_rss.py`: RSS ç›£è¦–å¼·åŒ–
- `v2/plugins/youtube_live_plugin.py`: è‡ªå‹•æŠ•ç¨¿ãƒ­ã‚¸ãƒƒã‚¯

**ä¸»è¦æ©Ÿèƒ½**:
```python
# RSS ã§æ–°ç€å‹•ç”»ã‚’æ¤œçŸ¥ â†’ API ã§è©³ç´°ç¢ºèª â†’ ãƒ©ã‚¤ãƒ–åˆ¤å®š â†’ è‡ªå‹•æŠ•ç¨¿
def fetch_youtube_rss_with_live_check(channel_id, api_plugin):
    videos = fetch_youtube_rss(channel_id)
    for video in videos:
        details = api_plugin._fetch_video_detail(video["video_id"])
        if details:
            content_type, live_status, _ = classify(details)
            if live_status == "live":
                auto_post_live_start(video)
```

### Phase 2: ãƒ©ã‚¤ãƒ–çµ‚äº†æ¤œçŸ¥

**å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«**:
- `v2/plugins/youtube_live_plugin.py`: å®šæœŸãƒãƒ¼ãƒªãƒ³ã‚°æ©Ÿèƒ½
- `v2/main_v2.py`: ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒªãƒ³ã‚°çµ±åˆ

**ä¸»è¦æ©Ÿèƒ½**:
```python
# DB ã‹ã‚‰ live_status='live' ã®å‹•ç”»ã‚’å–å¾— â†’ API ã§çŠ¶æ…‹ç¢ºèª â†’ çµ‚äº†æ¤œçŸ¥ â†’ è‡ªå‹•æŠ•ç¨¿
def poll_live_status():
    live_videos = db.get_videos_by_live_status("live")
    for video in live_videos:
        details = api_plugin._fetch_video_detail(video_id)
        if is_completed(details):
            db.update_video_status(video_id, "archive", "completed")
            auto_post_live_end(video)
```

**ãƒãƒ¼ãƒªãƒ³ã‚°é–“éš”**:
- ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 5åˆ†
- è¨­å®šå¯èƒ½: `YOUTUBE_LIVE_POLL_INTERVAL` (åˆ†å˜ä½)

### Phase 3: ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆçµ±åˆ

**æ—¢å­˜ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆé…ç½®æ¸ˆã¿ï¼‰**:
- `Asset/templates/youtube/yt_online_template.txt`: ãƒ©ã‚¤ãƒ–é–‹å§‹ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ âœ… é…ç½®æ¸ˆã¿
- `Asset/templates/youtube/yt_offline_template.txt`: ãƒ©ã‚¤ãƒ–çµ‚äº†ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ âœ… é…ç½®æ¸ˆã¿
- `templates/youtube/yt_online_template.txt`: å®Ÿè¡Œæ™‚ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ âœ… é…ç½®æ¸ˆã¿
- `templates/youtube/yt_offline_template.txt`: å®Ÿè¡Œæ™‚ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ âœ… é…ç½®æ¸ˆã¿

**ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆé¸æŠãƒ­ã‚¸ãƒƒã‚¯**:
```python
def _select_template(video, event_type):
    template_map = {
        "live_start": "templates/youtube/yt_online_template.txt",
        "live_end": "templates/youtube/yt_offline_template.txt",
        "new_video": "templates/youtube/yt_new_video_template.txt",
    }
    return template_map.get(event_type, default_template)
```

---

## ğŸ§ª ãƒ†ã‚¹ãƒˆè¨ˆç”»

### å˜ä½“ãƒ†ã‚¹ãƒˆ

```python
# test_scripts/test_youtube_live_detection.py

def test_live_start_detection():
    """ãƒ©ã‚¤ãƒ–é–‹å§‹æ¤œçŸ¥ã®ãƒ†ã‚¹ãƒˆ"""
    # RSS ã§æ–°ç€æ¤œçŸ¥ â†’ API ã§ live_status="live" â†’ DB ä¿å­˜ â†’ è‡ªå‹•æŠ•ç¨¿

def test_live_end_detection():
    """ãƒ©ã‚¤ãƒ–çµ‚äº†æ¤œçŸ¥ã®ãƒ†ã‚¹ãƒˆ"""
    # DB ã« live_status="live" â†’ API ã§ "completed" â†’ DB æ›´æ–° â†’ è‡ªå‹•æŠ•ç¨¿

def test_template_selection():
    """ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆè‡ªå‹•é¸æŠã®ãƒ†ã‚¹ãƒˆ"""
    # ã‚¤ãƒ™ãƒ³ãƒˆç¨®åˆ¥ â†’ æ­£ã—ã„ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãŒé¸æŠã•ã‚Œã‚‹
```

### çµ±åˆãƒ†ã‚¹ãƒˆ

```python
# test_scripts/test_youtube_live_integration.py

def test_full_live_workflow():
    """ãƒ©ã‚¤ãƒ–é…ä¿¡ã®å®Œå…¨ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼"""
    # 1. ãƒ©ã‚¤ãƒ–äºˆå®šæ¤œçŸ¥
    # 2. ãƒ©ã‚¤ãƒ–é–‹å§‹æ¤œçŸ¥ â†’ yt_online_template ã§æŠ•ç¨¿
    # 3. ãƒ©ã‚¤ãƒ–çµ‚äº†æ¤œçŸ¥ â†’ yt_offline_template ã§æŠ•ç¨¿
    # 4. ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–åŒ–ç¢ºèª
```

---

## ğŸ“„ ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ›´æ–°

### æ›´æ–°ãƒ•ã‚¡ã‚¤ãƒ«

- [x] `v2/docs/References/FUTURE_ROADMAP_v2.md`
  - Phase 2: YouTubeLive ãƒ—ãƒ©ã‚°ã‚¤ãƒ³å®Œæˆã‚’æ˜è¨˜
  - Phase 3: v3 ç¹°ã‚Šä¸‹ã’æ©Ÿèƒ½ã‚’è¿½åŠ 

- [ ] `README.md`
  - YouTubeLive å¯¾å¿œã‚’è¿½è¨˜

- [ ] `v2/docs/README_GITHUB_v2.md`
  - YouTubeLive å¯¾å¿œã‚’è¿½è¨˜

- [ ] `v2/docs/Technical/PLUGIN_SYSTEM.md`
  - YouTubeLive ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ä»•æ§˜ã‚’è¿½åŠ 

- [ ] `v2/settings.env.example`
  - ç’°å¢ƒå¤‰æ•°ã‚’è¿½åŠ ï¼š
    - `YOUTUBE_LIVE_POLL_INTERVAL`
    - `YOUTUBE_LIVE_AUTO_POST_START`
    - `YOUTUBE_LIVE_AUTO_POST_END`

### æ–°è¦ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- [x] `v2/docs/Technical/YOUTUBE_LIVE_PLUGIN_IMPLEMENTATION.md`
  - å®Ÿè£…ã‚¬ã‚¤ãƒ‰ï¼ˆè©³ç´°ç‰ˆï¼‰

---

## ğŸ“Š å®Ÿè£…å®Œäº†åº¦

| æ©Ÿèƒ½ | çŠ¶æ…‹ | å®Œäº†äºˆå®š |
|:--|:--:|:--|
| **YouTubeLive ãƒ—ãƒ©ã‚°ã‚¤ãƒ³** | | |
| â”œâ”€ ãƒ©ã‚¤ãƒ–é–‹å§‹æ¤œçŸ¥ | ğŸ”„ å®Ÿè£…äºˆå®š | v2.3.0 |
| â”œâ”€ ãƒ©ã‚¤ãƒ–çµ‚äº†æ¤œçŸ¥ | ğŸ”„ å®Ÿè£…äºˆå®š | v2.3.0 |
| â””â”€ ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆè‡ªå‹•é©ç”¨ | ğŸ”„ å®Ÿè£…äºˆå®š | v2.3.0 |
| **ä¸€æ‹¬æŠ•ç¨¿ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«** | âŒ v3ç¹°ã‚Šä¸‹ã’ | v3 |
| **GUI æ©Ÿèƒ½æ‹¡å¼µ** | âŒ v3ç¹°ã‚Šä¸‹ã’ | v3 |
| **ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ»å¾©å…ƒ** | âŒ v3ç¹°ã‚Šä¸‹ã’ | v3 |

---

## ğŸ¯ å®Ÿè£…ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

### ã‚³ãƒ¼ãƒ‰å®Ÿè£…

- [ ] RSS ç›£è¦–å¼·åŒ–ï¼ˆ`youtube_rss.py`ï¼‰
  - `fetch_youtube_rss_with_live_check()` ãƒ¡ã‚½ãƒƒãƒ‰ã®å®Ÿè£…
- [ ] ãƒ©ã‚¤ãƒ–é–‹å§‹æ¤œçŸ¥ï¼ˆ`youtube_live_plugin.py`ï¼‰
  - `auto_post_live_start(video)` ãƒ¡ã‚½ãƒƒãƒ‰ã®å®Ÿè£…
- [ ] ãƒ©ã‚¤ãƒ–çµ‚äº†æ¤œçŸ¥ï¼ˆå®šæœŸãƒãƒ¼ãƒªãƒ³ã‚°ï¼‰
  - `poll_live_status()` ãƒ¡ã‚½ãƒƒãƒ‰ã®å®Ÿè£…
  - `auto_post_live_end(video)` ãƒ¡ã‚½ãƒƒãƒ‰ã®å®Ÿè£…
- [ ] ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆè‡ªå‹•é¸æŠãƒ­ã‚¸ãƒƒã‚¯
  - `bluesky_plugin.py::post_video()` ã« `live_status` åˆ†å²ã‚’è¿½åŠ 
  - ç¾åœ¨ã¯ `source` ã®ã¿ã§åˆ¤å®šï¼ˆyoutube/niconicoï¼‰
- [ ] è‡ªå‹•æŠ•ç¨¿ãƒ­ã‚¸ãƒƒã‚¯çµ±åˆ
  - main_v2.py ã«å®šæœŸãƒãƒ¼ãƒªãƒ³ã‚°ã‚¹ãƒ¬ãƒƒãƒ‰ã‚’è¿½åŠ 
- [ ] ç’°å¢ƒå¤‰æ•°è¿½åŠ ï¼ˆ`settings.env.example`ï¼‰
  - `YOUTUBE_LIVE_POLL_INTERVAL`
  - `YOUTUBE_LIVE_AUTO_POST_START`
  - `YOUTUBE_LIVE_AUTO_POST_END`
- [ ] DB ã‚¯ã‚¨ãƒªãƒ˜ãƒ«ãƒ‘ãƒ¼è¿½åŠ ï¼ˆ`database.py`ï¼‰
  - `get_videos_by_live_status(status)` ãƒ¡ã‚½ãƒƒãƒ‰ã®å®Ÿè£…

### ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ

- [x] `Asset/templates/youtube/yt_online_template.txt` ä½œæˆï¼ˆé…ç½®æ¸ˆã¿ï¼‰
- [x] `Asset/templates/youtube/yt_offline_template.txt` ä½œæˆï¼ˆé…ç½®æ¸ˆã¿ï¼‰
- [ ] ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆè‡ªå‹•é¸æŠãƒ­ã‚¸ãƒƒã‚¯ã®å®Ÿè£…ï¼ˆ`bluesky_plugin.py`ï¼‰

### ãƒ†ã‚¹ãƒˆ

- [ ] å˜ä½“ãƒ†ã‚¹ãƒˆå®Ÿè£…
- [ ] çµ±åˆãƒ†ã‚¹ãƒˆå®Ÿè£…
- [ ] å®Ÿç’°å¢ƒãƒ†ã‚¹ãƒˆï¼ˆå®Ÿéš›ã®ãƒ©ã‚¤ãƒ–é…ä¿¡ã§æ¤œè¨¼ï¼‰

### ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- [ ] README.md æ›´æ–°
- [ ] README_GITHUB_v2.md æ›´æ–°
- [ ] PLUGIN_SYSTEM.md æ›´æ–°
- [ ] settings.env.example æ›´æ–°

### ãƒªãƒªãƒ¼ã‚¹

- [ ] ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç•ªå·æ›´æ–°ï¼ˆv2.3.0ï¼‰
- [ ] ãƒªãƒªãƒ¼ã‚¹ãƒãƒ¼ãƒˆä½œæˆ
- [ ] Git ã‚¿ã‚°ä½œæˆ
- [ ] GitHub Release å…¬é–‹

---

## ğŸ“ å¤‰æ›´å±¥æ­´

| æ—¥ä»˜ | å†…å®¹ |
|:--|:--|
| 2025-12-18 | v2 å®Œäº†è¨ˆç”»ç­–å®šã€v3 ç¹°ã‚Šä¸‹ã’æ©Ÿèƒ½æ•´ç† |

---

**æ¬¡å›ã‚¢ã‚¯ã‚·ãƒ§ãƒ³**: YouTubeLive ãƒ—ãƒ©ã‚°ã‚¤ãƒ³å®Ÿè£…é–‹å§‹
