# v2 ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã¨è¨­è¨ˆæ–¹é‡ - å®Œå…¨ã‚¬ã‚¤ãƒ‰

**å¯¾è±¡ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: v2.1.0+
**æœ€çµ‚æ›´æ–°**: 2025-12-18
**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: âœ… å®Ÿè£…å®Œäº†ãƒ»æ¤œè¨¼æ¸ˆã¿

---

## ğŸ“– ç›®æ¬¡

1. [åŸºæœ¬æ–¹é‡](#åŸºæœ¬æ–¹é‡)
2. [ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£](#ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£)
3. [ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£](#ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£)
4. [ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆ](#ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆ)
5. [ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«æ§‹æˆ](#ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«æ§‹æˆ)
6. [ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆAPI](#ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆapi)
7. [ãƒ—ãƒ©ã‚°ã‚¤ãƒ³çµ±åˆ](#ãƒ—ãƒ©ã‚°ã‚¤ãƒ³çµ±åˆ)

---

## åŸºæœ¬æ–¹é‡

### ã€Œã‚³ã‚¢ã€ã¨ã€Œã‚¨ã‚¯ã‚¹ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã€ã®åˆ†é›¢

StreamNotify v2 ã¯ä»¥ä¸‹ã®äºŒå±¤æ§‹é€ ã‚’æ¡ç”¨ã—ã¾ã™ï¼š

#### 1. ã‚³ã‚¢ï¼ˆãƒãƒ‹ãƒ©çŠ¶æ…‹ã€ãƒ—ãƒ©ã‚°ã‚¤ãƒ³æœªå°å…¥ï¼‰

**æ©Ÿèƒ½ç¯„å›²**:
- YouTube RSS ãƒãƒ¼ãƒªãƒ³ã‚°ï¼†RSSè§£æ
- ãƒ­ãƒ¼ã‚«ãƒ«DBï¼ˆSQLite `data/video_list.db`ï¼‰ã¸ã®å‹•ç”»æƒ…å ±ä¿å­˜
- ãƒ†ã‚­ã‚¹ãƒˆï¼‹URL ã«ã‚ˆã‚‹ Bluesky æŠ•ç¨¿
- ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«è¨˜éŒ²ï¼ˆ`logs/app.log`, `logs/error.log`ï¼‰
- Tkinter GUI ã«ã‚ˆã‚‹å‹•ç”»è¡¨ç¤ºãƒ»é¸æŠãƒ»æŠ•ç¨¿å®Ÿè¡Œãƒ»çµ±è¨ˆè¡¨ç¤º

**è²¬å‹™**:
- RSS ã‹ã‚‰æ–°ç€å‹•ç”»ã‚’æ¤œå‡ºã—ã€DB ã«ä¿å­˜ï¼ˆ`video_id` ã§é‡è¤‡åˆ¤å®šï¼‰
- æŠ•ç¨¿å¯¾è±¡ã‚’ DB ã‹ã‚‰å–å¾—ã—ã€ç°¡æ½”ãªãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã§æŠ•ç¨¿
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®é‹ç”¨ãƒ•ãƒ­ãƒ¼ã‚’ã‚µãƒãƒ¼ãƒˆ

**å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«**:
- `main_v2.py`: ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆãƒ»ãƒ¡ã‚¤ãƒ³ãƒ«ãƒ¼ãƒ—
- `config.py`: è¨­å®šèª­ã¿è¾¼ã¿ãƒ»ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
- `database.py`: SQLiteæ“ä½œãƒ»ãƒ†ãƒ¼ãƒ–ãƒ«ç®¡ç†
- `youtube_rss.py`: RSS å–å¾—ãƒ»ãƒ‘ãƒ¼ã‚¹
- `bluesky_core.py`: Bluesky æŠ•ç¨¿å‡¦ç†ï¼ˆãƒ­ã‚°ã‚¤ãƒ³ãƒ»URL Facetæ§‹ç¯‰ï¼‰
- `gui_v2.py`: Tkinter GUI
- `logging_config.py`: ãƒ­ã‚®ãƒ³ã‚°è¨­å®š

#### 2. ã‚¨ã‚¯ã‚¹ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ï¼ˆãƒ—ãƒ©ã‚°ã‚¤ãƒ³ï¼‰

**æ©Ÿèƒ½ç¯„å›²**:
- YouTube Data API é€£æºï¼ˆãƒ©ã‚¤ãƒ–åˆ¤å®šã€è©³ç´°æƒ…å ±å–å¾—ï¼‰
- ãƒ‹ã‚³ãƒ‹ã‚³å‹•ç”» RSS ç›£è¦–
- ç”»åƒæ·»ä»˜ãƒ»ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆå‡¦ç†æ‹¡å¼µ
- çµ±åˆãƒ­ã‚®ãƒ³ã‚°ç®¡ç†

**è²¬å‹™**:
- ã‚³ã‚¢ã® NotificationPlugin ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ ã‚’å®Ÿè£…ã—ã€`plugins/` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«é…ç½®
- è‡ªå‹•ãƒ­ãƒ¼ãƒ‰ãƒ»æœ‰åŠ¹åŒ–ã•ã‚Œã‚‹
- ã‚³ã‚¢æ©Ÿèƒ½ã‚’æ‹¡å¼µã™ã‚‹ãŒã€ã‚³ã‚¢ã®è²¬å‹™ã‚’å¥ªã‚ãªã„

**å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«**:
- `plugins/bluesky_plugin.py`: BlueskyæŠ•ç¨¿ãƒ—ãƒ©ã‚°ã‚¤ãƒ³
- `plugins/youtube_api_plugin.py`: YouTube APIé€£æº
- `plugins/youtube_live_plugin.py`: ãƒ©ã‚¤ãƒ–åˆ¤å®š
- `plugins/niconico_plugin.py`: ãƒ‹ã‚³ãƒ‹ã‚³ç›£è¦–
- `plugins/logging_plugin.py`: ãƒ­ã‚®ãƒ³ã‚°æ‹¡å¼µ

---

## ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### å‡¦ç†ãƒ•ãƒ­ãƒ¼

```
èµ·å‹•
  â†“
settings.env èª­ã¿è¾¼ã¿ & ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆconfig.pyï¼‰
  â†“
SQLite DB åˆæœŸåŒ–ï¼ˆdatabase.pyï¼‰
  â†“
YouTube RSS ç›£è¦–åˆæœŸåŒ–ï¼ˆyoutube_rss.pyï¼‰
  â†“
ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼åˆæœŸåŒ–ï¼†ãƒ—ãƒ©ã‚°ã‚¤ãƒ³èª­ã¿è¾¼ã¿
  â””â”€ è‡ªå‹•ãƒ­ãƒ¼ãƒ‰: bluesky_plugin, youtube_api_plugin, youtube_live_plugin, niconico_plugin, logging_pluginï¼ˆå­˜åœ¨æ™‚ï¼‰
  â†“
GUI ã‚¹ãƒ¬ãƒƒãƒ‰èµ·å‹•ï¼ˆgui_v2.pyã€ç‹¬ç«‹ã—ã¦å‹•ä½œï¼‰
  â†“
[ãƒ¡ã‚¤ãƒ³ãƒ«ãƒ¼ãƒ—] POLL_INTERVAL_MINUTES ã”ã¨ã«ä»¥ä¸‹ã‚’ç¹°ã‚Šè¿”ï¼ˆGUI ã¨ä¸¦è¡Œï¼‰:
  â”œâ”€ YouTube RSS å–å¾—ï¼†ã‚µãƒ ãƒã‚¤ãƒ«è‡ªå‹•å‡¦ç†
  â”œâ”€ æ–°ç€å‹•ç”»ã‚’ DB ã«ä¿å­˜
  â”œâ”€ åé›†ãƒ¢ãƒ¼ãƒ‰ï¼ˆAPP_MODE=collectï¼‰ã®å ´åˆ:
  â”‚   â””â”€ ã“ã“ã§çµ‚äº†ï¼ˆæŠ•ç¨¿å‡¦ç†ã‚¹ã‚­ãƒƒãƒ—ï¼‰
  â”œâ”€ é€šå¸¸ãƒ¢ãƒ¼ãƒ‰ï¼ˆAPP_MODE=normalï¼‰ã®å ´åˆ:
  â”‚   â”œâ”€ GUI ã§é¸æŠã•ã‚ŒãŸå‹•ç”»ã‚’å–å¾—
  â”‚   â”œâ”€ æŠ•ç¨¿é–“éš”ãƒã‚§ãƒƒã‚¯
  â”‚   â””â”€ æŠ•ç¨¿å¯¾è±¡ã‚ã‚Š & é–“éš”OK ãªã‚‰:
  â”‚       â””â”€ Bluesky ã«æŠ•ç¨¿
  â”‚           â”œâ”€ bluesky_plugin.py â†’ bluesky_core.pyï¼ˆæŠ•ç¨¿å®Ÿè¡Œï¼‰
  â”‚           â””â”€ æŠ•ç¨¿æ¸ˆã¿ãƒ•ãƒ©ã‚°æ›´æ–°
  â””â”€ ãƒãƒ¼ãƒªãƒ³ã‚°é–“éš”åˆ† sleep
  â†“
Ctrl+C ã§å®‰å…¨çµ‚äº†
```

### GUI ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆï¼ˆv2.1.0+ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ StreamNotify on Bluesky - DB ç®¡ç†                                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                              â”‚
â”‚ [ğŸ”„ å†èª­è¾¼] [â˜‘ï¸ å…¨é¸æŠ] [â˜ å…¨è§£é™¤] | [ğŸ’¾ ä¿å­˜] [ğŸ—‘ï¸ å‰Šé™¤] | [ğŸ§ª æŠ•ç¨¿ãƒ†ã‚¹ãƒˆ] [ğŸ“¤ æŠ•ç¨¿è¨­å®š] [â„¹ï¸ çµ±è¨ˆ] [ğŸ”Œ ãƒ—ãƒ©ã‚°ã‚¤ãƒ³] â”‚
â”‚                                                                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                              â”‚
â”‚ â˜ â”‚Video ID â”‚å…¬é–‹æ—¥æ™‚      â”‚é…ä¿¡å…ƒ    â”‚ã‚¿ã‚¤ãƒˆãƒ«            â”‚æŠ•ç¨¿äºˆå®š/æŠ•ç¨¿æ—¥æ™‚â”‚æŠ•ç¨¿å®Ÿç¸¾â”‚ç”»åƒãƒ¢ãƒ¼ãƒ‰â”‚
â”‚ â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚ â˜‘ â”‚-Vnx9CUoâ”‚2025-12-15    â”‚youtube   â”‚[TwitchåŒæ™‚é…ä¿¡]... â”‚2025-12-15    â”‚âœ“    â”‚import  â”‚
â”‚ â˜‘ â”‚iB-ajHPâ”‚2025-10-29    â”‚youtube   â”‚[TwitchåŒæ™‚é…ä¿¡]... â”‚æœªæ˜         â”‚âœ“    â”‚import  â”‚
â”‚ â˜ â”‚p4AJDhenâ”‚2025-10-29    â”‚youtube   â”‚[TwitchåŒæ™‚é…ä¿¡]... â”‚æœªæ˜         â”‚âœ“    â”‚import  â”‚
â”‚ â˜ â”‚PpCNLENWâ”‚2025-10-28    â”‚youtube   â”‚[éŒ²ï¼šäºˆå®šæ™‚åˆ»]...   â”‚æœªæ˜         â”‚âœ“    â”‚import  â”‚
â”‚                                                                                              â”‚
â”‚  ï¼ˆã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«å¯èƒ½ï¼‰                                                                          â”‚
â”‚                                                                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  èª­ã¿è¾¼ã¿å®Œäº†: 11 ä»¶ã®å‹•ç”»ï¼ˆé¸æŠ: 0 ä»¶ï¼‰                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**âœ¨ v2.1.0 æ–°æ©Ÿèƒ½:**
- **ğŸ§ª æŠ•ç¨¿ãƒ†ã‚¹ãƒˆ**: DRY RUN ãƒ¢ãƒ¼ãƒ‰ã§æŠ•ç¨¿ã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆ
- **ğŸ“¤ æŠ•ç¨¿è¨­å®š**: æŠ•ç¨¿è¨­å®šã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã§ç”»åƒæ·»ä»˜ãƒ»ãƒªã‚µã‚¤ã‚ºè¨­å®šã‚’èª¿æ•´
- **ğŸ”Œ ãƒ—ãƒ©ã‚°ã‚¤ãƒ³**: ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ç®¡ç†ç”»é¢

---

## ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### NotificationPlugin ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹

ã™ã¹ã¦ã®é€šçŸ¥ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãŒå®Ÿè£…ã™ã¹ãæŠ½è±¡åŸºåº•ã‚¯ãƒ©ã‚¹ã§ã™ã€‚

**å¿…é ˆãƒ¡ã‚½ãƒƒãƒ‰**:

```python
class NotificationPlugin(ABC):
    @abstractmethod
    def post_video(self, video: Dict[str, Any]) -> bool:
        """å‹•ç”»æƒ…å ±ã‚’ãƒã‚¹ãƒˆ"""
        pass

    @abstractmethod
    def is_available(self) -> bool:
        """ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãŒåˆ©ç”¨å¯èƒ½ã‹åˆ¤å®š"""
        pass

    @abstractmethod
    def get_name(self) -> str:
        """ãƒ—ãƒ©ã‚°ã‚¤ãƒ³åã‚’å–å¾—"""
        pass

    @abstractmethod
    def get_version(self) -> str:
        """ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’å–å¾—"""
        pass
```

**ã‚ªãƒ—ã‚·ãƒ§ãƒ³ãƒ¡ã‚½ãƒƒãƒ‰**:
- `get_description() -> str`: ãƒ—ãƒ©ã‚°ã‚¤ãƒ³èª¬æ˜
- `on_enable()`: æœ‰åŠ¹åŒ–æ™‚ã®ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯
- `on_disable()`: ç„¡åŠ¹åŒ–æ™‚ã®ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯

### PluginManagerï¼ˆãƒ—ãƒ©ã‚°ã‚¤ãƒ³ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ï¼‰

è¤‡æ•°ã®ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’ä¸€å…ƒç®¡ç†ã—ã¾ã™ã€‚

**æ©Ÿèƒ½**:
- ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‹ã‚‰ã®è‡ªå‹•æ¤œå‡ºãƒ»èª­ã¿è¾¼ã¿
- ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®æœ‰åŠ¹åŒ–ãƒ»ç„¡åŠ¹åŒ–
- ã™ã¹ã¦ã®æœ‰åŠ¹ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã§ã®ä¸€æ‹¬ãƒã‚¹ãƒˆ

**ä½¿ç”¨ä¾‹**:

```python
from plugin_manager import PluginManager

manager = PluginManager(plugins_dir="plugins")

# ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®èª­ã¿è¾¼ã¿
manager.load_plugins_from_directory()

# ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®æœ‰åŠ¹åŒ–
manager.enable_plugin("bluesky")

# ã™ã¹ã¦ã®æœ‰åŠ¹ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã§ãƒã‚¹ãƒˆ
results = manager.post_video_with_all_enabled(video_dict)

# DRY RUN ãƒ¢ãƒ¼ãƒ‰
results = manager.post_video_with_all_enabled(video_dict, dry_run=True)
```

### ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ 

```
plugins/
  __init__.py
  bluesky_plugin.py          # Bluesky æŠ•ç¨¿ãƒ—ãƒ©ã‚°ã‚¤ãƒ³
  youtube_api_plugin.py      # YouTube Data API é€£æº
  youtube_live_plugin.py     # YouTube ãƒ©ã‚¤ãƒ–åˆ¤å®š
  niconico_plugin.py         # ãƒ‹ã‚³ãƒ‹ã‚³å‹•ç”» RSS ç›£è¦–
  logging_plugin.py          # ãƒ­ã‚®ãƒ³ã‚°çµ±åˆç®¡ç†
```

### æ–°ã—ã„ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®è¿½åŠ æ–¹æ³•

#### 1. ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚¯ãƒ©ã‚¹ã‚’å®Ÿè£…

```python
# plugins/twitch_plugin.py

from plugin_interface import NotificationPlugin

class TwitchPlugin(NotificationPlugin):
    def __init__(self):
        self.client = None
        # åˆæœŸåŒ–å‡¦ç†

    def post_video(self, video: dict) -> bool:
        """Twitch ã«æŠ•ç¨¿"""
        try:
            # ãƒã‚¹ãƒˆå‡¦ç†
            return True
        except Exception as e:
            logger.error(f"âŒ Twitch æŠ•ç¨¿å¤±æ•—: {e}")
            return False

    def is_available(self) -> bool:
        """Twitch OAuth ãƒˆãƒ¼ã‚¯ãƒ³ãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹"""
        return os.getenv("TWITCH_OAUTH_TOKEN") is not None

    def get_name(self) -> str:
        return "TwitchPlugin"

    def get_version(self) -> str:
        return "1.0.0"

    def get_description(self) -> str:
        return "Twitch ãƒãƒ£ãƒƒãƒˆã«å‹•ç”»ã‚’æŠ•ç¨¿"
```

#### 2. PluginManager ãŒè‡ªå‹•ãƒ­ãƒ¼ãƒ‰

`plugins/` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«é…ç½®ã™ã‚‹ã¨ã€è‡ªå‹•çš„ã«æ¤œå‡ºãƒ»ãƒ­ãƒ¼ãƒ‰ã•ã‚Œã¾ã™ã€‚

---

## ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆ

### ãƒ†ãƒ¼ãƒ–ãƒ«: `videos`

| ã‚«ãƒ©ãƒ  | å‹ | åˆ¶ç´„ | èª¬æ˜ |
|--------|----|----|------|
| `id` | INTEGER | PRIMARY KEY AUTO_INCREMENT | ä¸»ã‚­ãƒ¼ |
| `video_id` | TEXT | UNIQUE, NOT NULL | YouTube å‹•ç”» ID |
| `title` | TEXT | NOT NULL | å‹•ç”»ã‚¿ã‚¤ãƒˆãƒ« |
| `video_url` | TEXT | NOT NULL | å‹•ç”» URL |
| `published_at` | TEXT | NOT NULL | å…¬é–‹æ—¥æ™‚ï¼ˆISO 8601ï¼‰ |
| `channel_name` | TEXT | | ãƒãƒ£ãƒ³ãƒãƒ«å |
| `source` | TEXT | DEFAULT 'youtube' | å‹•ç”»é…ä¿¡å…ƒï¼ˆyoutube, niconico ãªã©ï¼‰å°æ–‡å­— |
| `posted_to_bluesky` | INTEGER | DEFAULT 0 | æŠ•ç¨¿æ¸ˆã¿ãƒ•ãƒ©ã‚°ï¼ˆ0=æœªæŠ•ç¨¿, 1=æŠ•ç¨¿æ¸ˆã¿ï¼‰ |
| `posted_at` | TEXT | | æŠ•ç¨¿å®Ÿè¡Œæ—¥æ™‚ï¼ˆISO 8601ï¼‰ |
| `content_type` | TEXT | DEFAULT 'video' | ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ç¨®åˆ¥ï¼ˆ"video", "live", "archive", "none"ï¼‰ |
| `live_status` | TEXT | DEFAULT NULL | ãƒ©ã‚¤ãƒ–é…ä¿¡çŠ¶æ…‹ï¼ˆnull, "upcoming", "live", "completed"ï¼‰ |
| `image_filename` | TEXT | | ä¿å­˜æ¸ˆã¿ã‚µãƒ ãƒã‚¤ãƒ«ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«å |
| `thumbnail_url` | TEXT | | ã‚µãƒ ãƒã‚¤ãƒ«ç”»åƒã® URL |

**å€¤ã®æ­£è¦åŒ–** (database.py ã§å®Ÿæ–½):
- `source`: ã™ã¹ã¦å°æ–‡å­—ï¼ˆ"youtube", "niconico"ï¼‰
- `content_type`: "video", "live", "archive", "none" ã®ã„ãšã‚Œã‹
- `live_status`: null, "none", "upcoming", "live", "completed" ã®ã„ãšã‚Œã‹

---

## ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«æ§‹æˆ

### ã‚³ã‚¢ãƒ­ã‚¸ãƒƒã‚¯

| ãƒ•ã‚¡ã‚¤ãƒ«å | å½¹å‰² | èª¬æ˜ |
|-----------|------|------|
| `main_v2.py` | ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆãƒ»ãƒ¡ã‚¤ãƒ³ãƒ«ãƒ¼ãƒ— | èµ·å‹•ã€ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ç®¡ç†ã€ãƒ¡ã‚¤ãƒ³ãƒ«ãƒ¼ãƒ—ã§ RSS â†’ DB â†’ æŠ•ç¨¿ |
| `config.py` | è¨­å®šèª­ã¿è¾¼ã¿ãƒ»ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ | settings.env ã‹ã‚‰è¨­å®šå–å¾—ã€å€¤ãƒã‚§ãƒƒã‚¯ |
| `database.py` | SQLite æ“ä½œ | ãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆã€INSERT/SELECT/UPDATE/DELETEã€å€¤æ­£è¦åŒ– |
| `youtube_rss.py` | RSS å–å¾—ãƒ»ãƒ‘ãƒ¼ã‚¹ | YouTube ãƒãƒ£ãƒ³ãƒãƒ« RSS URL ç”Ÿæˆã€RSS å–å¾—ã€æ–°ç€å‹•ç”»æŠ½å‡º |
| `plugin_manager.py` | ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ç®¡ç† | ãƒ—ãƒ©ã‚°ã‚¤ãƒ³è‡ªå‹•æ¤œå‡ºãƒ»èª­ã¿è¾¼ã¿ãƒ»æœ‰åŠ¹åŒ–ãƒ»ç„¡åŠ¹åŒ– |
| `plugin_interface.py` | ãƒ—ãƒ©ã‚°ã‚¤ãƒ³åŸºæœ¬ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ | ãƒ—ãƒ©ã‚°ã‚¤ãƒ³åŸºæœ¬ã‚¯ãƒ©ã‚¹ï¼ˆNotificationPluginï¼‰ |

### ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£

| ãƒ•ã‚¡ã‚¤ãƒ«å | å½¹å‰² | èª¬æ˜ |
|-----------|------|------|
| `bluesky_core.py` | Bluesky æŠ•ç¨¿å‡¦ç† | ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã€ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ¬ãƒ³ãƒ€ã€æŠ•ç¨¿å®Ÿè¡Œ |
| `logging_config.py` | ãƒ­ã‚®ãƒ³ã‚°è¨­å®š | ãƒ­ã‚¬ãƒ¼åˆæœŸåŒ–ã€ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«è¨­å®šã€ãƒ•ã‚¡ã‚¤ãƒ«ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ |
| `image_manager.py` | ç”»åƒç®¡ç† | ç”»åƒãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã€å½¢å¼å¤‰æ›ã€ãƒªãƒˆãƒ©ã‚¤å‡¦ç† |
| `image_processor.py` | ç”»åƒãƒªã‚µã‚¤ã‚ºå‡¦ç† | ä¸‰æ®µéšãƒªã‚µã‚¤ã‚ºæˆ¦ç•¥ã€JPEGå“è³ªæœ€é©åŒ– |
| `utils_v2.py` | ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•° | æ—¥æ™‚ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã€ãƒªãƒˆãƒ©ã‚¤ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ |
| `gui_v2.py` | GUIï¼ˆTkinterï¼‰ | å‹•ç”»ä¸€è¦§è¡¨ç¤ºã€é¸æŠã€æŠ•ç¨¿å®Ÿè¡Œã€å‰Šé™¤ |

### ãƒ—ãƒ©ã‚°ã‚¤ãƒ³

| ãƒ•ã‚¡ã‚¤ãƒ«å | ç¨®é¡ | èª¬æ˜ |
|-----------|------|------|
| `bluesky_plugin.py` | æ©Ÿèƒ½æ‹¡å¼µ | Bluesky æŠ•ç¨¿ãƒ©ãƒƒãƒ‘ |
| `niconico_plugin.py` | ã‚µã‚¤ãƒˆé€£æº | ãƒ‹ã‚³ãƒ‹ã‚³å‹•ç”» RSS ç›£è¦– |
| `youtube_api_plugin.py` | ã‚µã‚¤ãƒˆé€£æº | YouTube Data API é€£æº |
| `youtube_live_plugin.py` | ã‚µã‚¤ãƒˆé€£æº | YouTube ãƒ©ã‚¤ãƒ–åˆ¤å®šï¼ˆå®Ÿé¨“çš„ï¼‰ |
| `logging_plugin.py` | æ©Ÿèƒ½æ‹¡å¼µ | ãƒ­ã‚®ãƒ³ã‚°çµ±åˆç®¡ç† |

---

## ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆAPI

### APIå®‰å®šåŒ–ã¨UIåˆ†é›¢

ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã¯ Jinja2 å½¢å¼ã¨ã—ã€ä»¥ä¸‹ã® `event_context` dict ã‚’å¸¸ã«å—ã‘å–ã‚Œã‚‹ã“ã¨ã‚’ä¿è¨¼ã—ã¾ã™ï¼š

### event_context ã‚­ãƒ¼å®šç¾©

| ã‚­ãƒ¼å | å‹ | èª¬æ˜ | å¤‰æ›´ç¦æ­¢ |
|--------|----|----|---------|
| `title` | str | å‹•ç”»ã‚¿ã‚¤ãƒˆãƒ« | âœ… |
| `video_id` | str | YouTube/ãƒ‹ã‚³ãƒ‹ã‚³ç­‰ã®å‹•ç”»ID | âœ… |
| `video_url` | str | å‹•ç”»URL | âœ… |
| `channel_name` | str | ãƒãƒ£ãƒ³ãƒãƒ«å | âœ… |
| `published_at` | str | å…¬é–‹æ—¥æ™‚ï¼ˆISO 8601ï¼‰ | âœ… |
| `source` | str | å‹•ç”»é…ä¿¡å…ƒï¼ˆå°æ–‡å­—ï¼š"youtube", "niconico"ï¼‰ | âœ… |
| `content_type` | str | ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ç¨®åˆ¥ï¼ˆ"video", "live", "archive", "none"ï¼‰ | âœ… |
| `live_status` | str or None | ãƒ©ã‚¤ãƒ–é…ä¿¡ã®çŠ¶æ…‹ï¼ˆnull, "upcoming", "live", "completed"ï¼‰ | âœ… |
| `image_filename` | str | ä¿å­˜æ¸ˆã¿ã‚µãƒ ãƒã‚¤ãƒ«ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«å | âœ… |
| `posted_at` | str | BlueskyæŠ•ç¨¿æ—¥æ™‚ï¼ˆISO 8601ã€æœªæŠ•ç¨¿æ™‚ã¯Noneï¼‰ | âœ… |

### ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ç½®ãå ´æ‰€

```
templates/
â”œâ”€â”€ youtube/
â”‚   â”œâ”€â”€ yt_new_video_template.txt      # YouTubeæ–°ç€å‹•ç”»ç”¨
â”‚   â”œâ”€â”€ yt_online_template.txt         # YouTubeé…ä¿¡é–‹å§‹ç”¨ï¼ˆå°†æ¥ï¼‰
â”‚   â””â”€â”€ yt_offline_template.txt        # YouTubeé…ä¿¡çµ‚äº†ç”¨ï¼ˆå°†æ¥ï¼‰
â””â”€â”€ niconico/
    â””â”€â”€ nico_new_video_template.txt    # ãƒ‹ã‚³ãƒ‹ã‚³æ–°ç€å‹•ç”»ç”¨
```

### æ‹¡å¼µãƒ«ãƒ¼ãƒ«

- **æ—¢å­˜ã‚­ãƒ¼ã®å‰Šé™¤ãƒ»å‹å¤‰æ›´ã¯ç¦æ­¢**
- **æ–°è¦ã‚­ãƒ¼ã®è¿½åŠ ã¯ OK** ã ãŒã€ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã¨ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’åŒæ™‚ã«æ›´æ–°
- **å¾Œæ–¹äº’æ›æ€§ã‚’ç¶­æŒ**ï¼ˆå¤ã„ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚‚å‹•ä½œã™ã‚‹ã‚ˆã†ã«ï¼‰

---

## ãƒ—ãƒ©ã‚°ã‚¤ãƒ³çµ±åˆ

### main_v2.py ã§ã® PluginManager çµ±åˆ

```python
# main_v2.py å†…ã®å®Ÿè£…
from plugin_manager import PluginManager

plugin_manager = PluginManager(plugins_dir="plugins")
# ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‹ã‚‰è‡ªå‹•ãƒ­ãƒ¼ãƒ‰
plugin_manager.load_plugins_from_directory()

# GUI ã«æ¸¡ã™
gui = StreamNotifyGUI(root, db, plugin_manager)

# GUI å†…ã§ä½¿ç”¨
results = self.plugin_manager.post_video_with_all_enabled(video, dry_run=False)
# DRY RUN: results = self.plugin_manager.post_video_with_all_enabled(video, dry_run=True)
```

### å‘¼ã³å‡ºã—ãƒ•ãƒ­ãƒ¼

```
main_v2.py::main()
â”‚
â”œâ”€ config.py ã‹ã‚‰è¨­å®šèª­ã¿è¾¼ã¿
â”œâ”€ logging_config.py ã§ãƒ­ã‚®ãƒ³ã‚°åˆæœŸåŒ–
â”œâ”€ database.py ã‹ã‚‰DBåˆæœŸåŒ–
â”œâ”€ plugin_manager.py ã§ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–
â”‚  â””â”€ plugins/ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‹ã‚‰å…¨ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’è‡ªå‹•ãƒ­ãƒ¼ãƒ‰
â”œâ”€ youtube_rss.py ã‹ã‚‰RSSå–å¾—
â””â”€ GUI ã‚’ãƒãƒ«ãƒã‚¹ãƒ¬ãƒƒãƒ‰ã§èµ·å‹•
   â”œâ”€ StreamNotifyGUI(root, db, plugin_manager)
   â”‚  â””â”€ setup_ui()
   â”‚     â””â”€ execute_post() â†’ plugin_manager.post_video_with_all_enabled()
   â””â”€ ãƒ¡ã‚¤ãƒ³ãƒ«ãƒ¼ãƒ—ã§ãƒãƒ¼ãƒªãƒ³ã‚°ç¶™ç¶š
```

---

**ä½œæˆæ—¥**: 2025-12-18
**æœ€å¾Œã®ä¿®æ­£**: 2025-12-18
**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: âœ… å®Œæˆãƒ»æ¤œè¨¼æ¸ˆã¿
